datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

model User {
  id           String        @id @default(cuid())
  username     String
  createdAt    DateTime      @default(now())
  userId       String        @unique
  usages       Usage[]
  subscription Subscription?
  contexts     Context[]
  questions    Question[]
}

model Question {
  id        String    @id @default(cuid())
  question  String
  answer    String
  createdAt DateTime
  repliedAt DateTime?
  user      User      @relation(fields: [userId], references: [id])
  userId    String
}

model Channel {
  id        String @id
  name      String
  channelID String @unique
  numAsks   Int
  numChats  Int
}

model Server {
  id        String @id @default(cuid())
  name      String
  serverID  String @unique
  numAsks   Int
  numChats  Int
  numTrans  Int
  numCtx    Int
  numCtxAsk Int
}

model Usage {
  id           String @id
  cmdAsk       Int
  cmdChat      Int
  cmdTranslate Int
  ctxAsk       Int
  ctxTranslate Int
  ctxContext   Int
  user         User   @relation(fields: [userId], references: [id])
  userId       String
}

model Context {
  id        String   @id @default(cuid())
  context   String
  createdAt DateTime
  user      User     @relation(fields: [userId], references: [id])
  usedCount Int
  userId    String
}

enum BillingType {
  MONTHLY
  ANNUAL
}

enum SubscriptionType {
  USER
  SERVER
}

enum SubscriptionTier {
  I
  II
  III
}

model Subscription {
  id               String           @id @default(cuid())
  startDate        DateTime
  endDate          DateTime
  billingType      BillingType
  subscriptionType SubscriptionType
  tier             SubscriptionTier
  isExpired        Boolean
  user             User             @relation(fields: [userId], references: [id])
  userId           String           @unique
}
